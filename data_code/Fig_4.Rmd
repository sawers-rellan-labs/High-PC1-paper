---
title: "fig4_enzyme_info"
author: "rra"
date: "5/4/2020"
output: html_document
---

```{r}
library(tidyverse)
library(data.table)
library(cowplot)
library(wesanderson)
library(ggplot2)
library(MASS) 
library(qtl)
library(lme4) 
library(arm) 
library(lsmeans) 
library(pbkrtest)
library(cowplot) 
library(viridis)
library(qtlcharts)
library(readr)
library(ggfortify)
library(ggmap)
library(maps)
library(qtlcharts)
library(Hmisc)
library(pegas)
```

fd from palomeros and mushito

```{r}
ril_data <- read_csv("data/fig_4/data_RILS_all.csv")

ril_data %>%
  #filter(GENOTYPE =="LANMLR17B042"| GENOTYPE =="LANMLR17B023"
  #       | GENOTYPE =="LANMLR17B035"| GENOTYPE =="LANMLR17B152"
  #       | GENOTYPE =="LANMLR17B021"| GENOTYPE =="LANMLR17B122") %>%
    filter(GENOTYPE =="LANMLR17B042"| GENOTYPE =="LANMLR17B023") %>%
  #filter(GENOTYPE =="LANMLR17B042") %>%
	ggplot(aes(x =GENOTYPE, y = log10(PCs/LPCs), color = geno_pla)) +
  geom_jitter(position=position_jitter(0.1), size = 4) +
  scale_color_manual(values=c("#df1b23", "#1260ad", "#fd6820", "#14ade8")) +
  stat_summary(fun.data=mean_sdl,fun.args = list(mult = 1), geom="pointrange", color = "black") +
  theme(legend.position="none") +
  facet_grid(rows = vars(GENOTYPE)) +
  theme_cowplot()
```
F1 expression data

```{r}


exp_valuesPLALPCAT <- read_csv("data/fig_4/ZmPla-Lpcat.csv")

ZmPla1_exp <- exp_valuesPLALPCAT %>%
  filter(gene=="ZmPla1.2") %>%
  #filter(fertilizer_tx=="high") %>%
	ggplot(aes(x = temp_tx, y = expression, color = temp_tx)) +
  scale_color_manual(values=c("#1260ad","#df1b23", "#fd6820", "#14ade8")) +
	geom_jitter(position=position_jitter(0.1), size = 3) +
  stat_summary(fun.data=mean_sdl,fun.args = list(mult = 1), geom="pointrange",
               color = "black") +
  #ylim(0,8) +
  ylab("ZmPla1.2") +
  xlab("Temperature") +
  theme_cowplot(16) +
  #facet_grid(cols = vars(line), rows = vars(fertilizer_tx)) +
  facet_grid(cols = vars(line)) +
  #coord_fixed(ratio = 0.9) +
  theme(legend.position="none",
        strip.background = element_rect(colour="white", fill="white"))

ZmLpcat_exp <- exp_valuesPLALPCAT %>%
  filter(gene=="ZmLpcat") %>%
  #filter(fertilizer_tx=="high") %>%
	ggplot(aes(x = temp_tx, y = expression, color = temp_tx)) +
  scale_color_manual(values=c("#1260ad","#df1b23", "#fd6820", "#14ade8")) +
	geom_jitter(position=position_jitter(0.1), size = 3) +
  stat_summary(fun.data=mean_sdl,fun.args = list(mult = 1), geom="pointrange",
               color = "black") +
  #ylim(0,8) +
  ylab("ZmLpcat1") +
  xlab("Temperature") +
  theme_cowplot(16) +
  #facet_grid(cols = vars(line), rows = vars(fertilizer_tx)) +
  facet_grid(cols = vars(line)) +
  #coord_fixed(ratio = 0.9) +
  theme(legend.position="none",
        strip.background = element_rect(colour="white", fill="white"))

ratio_exp <- exp_valuesPLALPCAT %>%
  filter(gene=="Ratio") %>%
  #filter(fertilizer_tx=="high") %>%
	ggplot(aes(x = temp_tx, y = expression, color = temp_tx)) +
  scale_color_manual(values=c("#1260ad","#df1b23", "#fd6820", "#14ade8")) +
	geom_jitter(position=position_jitter(0.1), size = 3) +
  stat_summary(fun.data=mean_sdl,fun.args = list(mult = 1), geom="pointrange",
               color = "black") +
  #ylim(0,8) +
  ylab("ZmPla1.2/ZmLpcat1") +
  xlab("Temperature") +
  theme_cowplot(16) +
  #facet_grid(cols = vars(line), rows = vars(fertilizer_tx)) +
  facet_grid(cols = vars(line)) +
  #coord_fixed(ratio = 0.9) +
  theme(legend.position="none",
        strip.background = element_rect(colour="white", fill="white"))

plot_grid(ZmPla1_exp, ZmLpcat_exp, ratio_exp, ncol = 1)

```



